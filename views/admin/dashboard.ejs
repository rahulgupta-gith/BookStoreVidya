<%- include('../layout') %>

<style>
    :root {
        --black: #0f0f1a;
        --dark-glass: rgba(255, 255, 255, 0.03);
        --glass-border: rgba(255, 255, 255, 0.08);
        --red-primary: #dc2626;
        --red-accent: #ef4444;
        --blue-accent: #3b82f6;
    }

    body {
        background: radial-gradient(circle at top right, #1a1a3a 0%, var(--black) 100%);
        color: #f8fafc;
        min-height: 100vh;
    }

    .admin-container { padding-top: 110px; padding-bottom: 60px; }

    /* Premium Toggle Switch */
    .admin-nav {
        background: var(--dark-glass);
        border: 1px solid var(--glass-border);
        padding: 5px;
        border-radius: 20px;
        display: inline-flex;
        backdrop-filter: blur(10px);
    }

    .nav-toggle-btn {
        border: none;
        background: transparent;
        color: rgba(255, 255, 255, 0.4);
        padding: 12px 30px;
        border-radius: 15px;
        font-weight: 700;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        font-size: 0.85rem;
        text-transform: uppercase;
        letter-spacing: 1px;
    }

    .nav-toggle-btn.active {
        background: linear-gradient(135deg, var(--red-primary), var(--red-accent));
        color: white;
        box-shadow: 0 8px 20px rgba(220, 38, 38, 0.4);
    }

    /* --- Data Strip Styling (The "Inside" part) --- */
    .data-card {
        background: rgba(255, 255, 255, 0.02);
        border: 1px solid var(--glass-border);
        border-radius: 20px;
        padding: 20px 25px;
        margin-bottom: 15px;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: space-between;
    }

    .data-card:hover {
        background: rgba(255, 255, 255, 0.05);
        border-color: rgba(220, 38, 38, 0.3);
        transform: scale(1.01);
    }

    .data-info h6 {
        margin: 0;
        font-weight: 700;
        font-size: 1.1rem;
        color: #fff;
    }

    .data-info p {
        margin: 0;
        font-size: 0.85rem;
        color: rgba(255, 255, 255, 0.5);
    }

    .avatar-icon {
        width: 50px;
        height: 50px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.4rem;
        margin-right: 20px;
        color: var(--red-accent);
    }

    /* Status Badges */
    .status-pill {
        padding: 6px 16px;
        border-radius: 100px;
        font-size: 0.7rem;
        font-weight: 800;
        text-transform: uppercase;
        letter-spacing: 1px;
    }

    .status-verified { background: rgba(25, 135, 84, 0.1); color: #22c55e; border: 1px solid rgba(34, 197, 94, 0.2); }
    .status-pending { background: rgba(245, 158, 11, 0.1); color: #f59e0b; border: 1px solid rgba(245, 158, 11, 0.2); }
    .status-blocked { background: rgba(220, 38, 38, 0.1); color: #ef4444; border: 1px solid rgba(239, 68, 68, 0.2); }

    .animate-in {
        animation: slideUp 0.6s ease-out both;
    }

    @keyframes slideUp {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }
</style>

<div class="container admin-container">
    <div class="d-flex flex-column flex-md-row justify-content-between align-items-md-center mb-5 animate-in">
        <div>
            <h1 class="display-6 fw-800 m-0">Command <span class="text-gradient-red">Center</span></h1>
            <p class="text-muted-soft">Securely manage the ecosystem assets and users.</p>
        </div>

        <div class="admin-nav mt-3 mt-md-0">
            <button class="nav-toggle-btn active" onclick="showSection('vendors', this)" id="vendorsBtn">Vendors</button>
            <button class="nav-toggle-btn" onclick="showSection('users', this)" id="usersBtn">Users</button>
        </div>
    </div>

    <div id="vendorsSection" class="animate-in">
        <% vendors.forEach(vendor => { %>
            <div class="data-card">
                <div class="d-flex align-items-center">
                    <div class="avatar-icon">
                        <i class="bi bi-shop"></i>
                    </div>
                    <div class="data-info">
                        <h6><%= vendor.name %></h6>
                        <p><i class="bi bi-envelope me-1"></i> <%= vendor.email %></p>
                    </div>
                </div>

                <div class="d-flex align-items-center gap-4">
                    <div>
                        <% if (vendor.isBlocked) { %>
                            <span class="status-pill status-blocked">Blocked</span>
                        <% } else if (!vendor.isVerified) { %>
                            <span class="status-pill status-pending">Pending</span>
                        <% } else { %>
                            <span class="status-pill status-verified">Verified</span>
                        <% } %>
                    </div>

                    <div class="d-flex gap-2">
                        <% if (!vendor.isVerified) { %>
                            <form method="POST" action="/admin/vendor/verify/<%= vendor._id %>">
                                <button class="btn btn-success btn-sm rounded-3 px-3">Verify</button>
                            </form>
                        <% } %>
                        <form method="POST" action="/admin/vendor/block/<%= vendor._id %>">
                            <button class="btn btn-outline-<%= vendor.isBlocked ? 'success' : 'danger' %> btn-sm rounded-3 px-3">
                                <%= vendor.isBlocked ? "Unblock" : "Block" %>
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        <% }) %>
    </div>

    <div id="usersSection" class="animate-in" style="display:none;">
        <% users.forEach(user => { %>
            <div class="data-card">
                <div class="d-flex align-items-center">
                    <div class="avatar-icon" style="color: var(--blue-accent);">
                        <i class="bi bi-person"></i>
                    </div>
                    <div class="data-info">
                        <h6><%= user.name %></h6>
                        <p><i class="bi bi-envelope me-1"></i> <%= user.email %></p>
                    </div>
                </div>

                <div class="data-info text-end">
                    <p class="text-white-50 small mb-1">Mobile Access</p>
                    <code class="text-info fs-6"><%= user.mobile %></code>
                </div>
            </div>
        <% }) %>
    </div>
</div>

<script>
    function showSection(type, btn) {
        document.querySelectorAll('.nav-toggle-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');

        const uSection = document.getElementById("usersSection");
        const vSection = document.getElementById("vendorsSection");

        if (type === "users") {
            uSection.style.display = "block";
            vSection.style.display = "none";
        } else {
            uSection.style.display = "none";
            vSection.style.display = "block";
        }
    }
</script>